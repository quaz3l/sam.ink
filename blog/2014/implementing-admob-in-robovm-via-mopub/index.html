
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<meta name="author" content="Sam Schooler">

<meta name="description" content="UPDATED November 29th, 2014: Should work with LibGDX 1.X.X
RoboVM is an amazing free framework for writing iOS Applications in Java. I built an app with LibGDX, which ties into RoboVM last week. I don’t feel that it is worth charging for, so I wanted to make it ad-supported. In order to do this, I needed to implement a native library from MoPub, a ad mediation network. I had a couple kinks, but I successfully implemented AdMob/MoPub, in both iOS and Android, and I want to share how I did it.
If you are only putting ads in a iOS app, only follow the steps labeled [iOS], or if you are doing only an Android app, follow the [Android] tag. Obviously, if you are making an app for both platforms, do everything.
Creating Your ProjectMake sure before you start, to follow the LibGDK Wiki on how to Create a Project. This will get you started with a LibGDX project. Then make sure to Import your Project Into Eclipse.
Getting Our ResourcesStarted out by downloading the [iOS] RoboVM Bindings and the [Android] Full MoPub SDK.
RoboVM bindings are basically “bridges” between the native iOS Objective-C and the sudo Objective-C Java RoboVM. This jar implements the Full MoPub iOS SDK, which allows us to get banners natively on iOS without writing a single line of Objective-C.">


<meta property="og:title" content="Implementing AdMob in RoboVM via MoPub"/>
<meta property="og:site_name" content="Sam Schooler"/>

<meta name="description" content="UPDATED November 29th, 2014: Should work with LibGDX 1.X.X
RoboVM is an amazing free framework for writing iOS Applications in Java. I built an app with LibGDX, which ties into RoboVM last week. I don">
<meta property="og:type" content="article">
<meta property="og:title" content="Implementing AdMob in RoboVM via MoPub">
<meta property="og:url" content="https://sam.ink/blog/2014/implementing-admob-in-robovm-via-mopub/">
<meta property="og:site_name" content="Sam Schooler">
<meta property="og:description" content="UPDATED November 29th, 2014: Should work with LibGDX 1.X.X
RoboVM is an amazing free framework for writing iOS Applications in Java. I built an app with LibGDX, which ties into RoboVM last week. I don">
<meta property="og:updated_time" content="2015-12-17T18:04:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Implementing AdMob in RoboVM via MoPub">
<meta name="twitter:description" content="UPDATED November 29th, 2014: Should work with LibGDX 1.X.X
RoboVM is an amazing free framework for writing iOS Applications in Java. I built an app with LibGDX, which ties into RoboVM last week. I don">
<meta name="twitter:creator" content="@samschooler">
<link rel="publisher" href="https://plus.google.com/u/0/+SamSchooler?rel=author">

<title>Implementing AdMob in RoboVM via MoPub | Sam Schooler</title>

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="Sam Schooler" type="application/atom+xml">
<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-32329980-1', 'auto');
	ga('send', 'pageview');

</script>



  </head>
  <body>
    
    <header>
      <div class="blog-name-holder left">
  <h1 class="blog-name">
    <a href="/">samschooler.</a>
  </h1>
  <h1 class="blog-name-short">
    <a href="/">sam.</a>
  </h1>
</div>
<ul class="menu right">
  
    <li><a href="/about">about.</a></li>
  
    <li><a href="/resume">resume.</a></li>
  
    <li><a href="mailto:hello@sam.ink">contact.</a></li>
  
</ul>
<div class="clear"></div>

    </header>
    <div class="wrapper">
      <section class="blog-posts">
  <article class="blog-post blog-post-post">
  <div class="article-header">
  
  <div class="article-date">Feb 16 2014</div>


  <h2 class="article-title">Implementing AdMob in RoboVM via MoPub</h2>

<div class="clear"></div>

</div>
<div class="article-body ">
  
    <p><em>UPDATED November 29th, 2014: Should work with LibGDX 1.X.X</em></p>
<p><a href="http://robovm.org" target="_blank" rel="external">RoboVM</a> is an amazing free framework for writing iOS Applications in Java. I built an app with LibGDX, which ties into RoboVM last week. I don’t feel that it is worth charging for, so I wanted to make it ad-supported. In order to do this, I needed to implement a native library from MoPub, a ad mediation network. I had a couple kinks, but I successfully implemented AdMob/MoPub, in both iOS and Android, and I want to share how I did it.</p>
<p>If you are only putting ads in a iOS app, only follow the steps labeled [iOS], or if you are doing only an Android app, follow the [Android] tag. Obviously, if you are making an app for both platforms, do everything.</p>
<h2 id="Creating_Your_Project"><a href="#Creating_Your_Project" class="headerlink" title="Creating Your Project"></a>Creating Your Project</h2><p>Make sure before you start, to follow the LibGDK Wiki on how to <a href="https://github.com/libgdx/libgdx/wiki/Project-Setup-Gradle" target="_blank" rel="external">Create a Project</a>. This will get you started with a LibGDX project. Then make sure to <a href="https://github.com/libgdx/libgdx/wiki/Gradle-and-Eclipse" target="_blank" rel="external">Import your Project Into Eclipse</a>.</p>
<h2 id="Getting_Our_Resources"><a href="#Getting_Our_Resources" class="headerlink" title="Getting Our Resources"></a>Getting Our Resources</h2><p>Started out by downloading the [iOS] <a href="http://libgdx.badlogicgames.com/robovm-ios-bindings/mopub-1.0.0-SNAPSHOT.jar" target="_blank" rel="external">RoboVM Bindings</a> and the [Android] <a href="https://github.com/mopub/mopub-android-sdk/archive/master.zip" target="_blank" rel="external">Full MoPub SDK</a>.</p>
<p>RoboVM bindings are basically “bridges” between the native iOS Objective-C and the sudo Objective-C Java RoboVM. This jar implements the Full MoPub iOS SDK, which allows us to get banners natively on iOS without writing a single line of Objective-C.</p>
<a id="more"></a>
<h2 id="Work_With_Gradle"><a href="#Work_With_Gradle" class="headerlink" title="Work With Gradle"></a>Work With Gradle</h2><p>In order for our project to recognize the MoPub SDK, we need to tell Gradle to include it in our builds.</p>
<p><strong>[Android]</strong><br>Open the build.gradle file in the root directory of your project, find the <code>project(&quot;:android&quot;)</code> section, and add <code>compile fileTree(dir: &#39;libs&#39;, include: &#39;*.jar&#39;)</code>. It should now look like this:<br><figure class="highlight"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">project(":android") &#123;</span><br><span class="line">    apply plugin: "android"</span><br><span class="line">    configurations &#123; natives &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(":core")</span><br><span class="line">        compile "com.badlogicgames.gdx:gdx-backend-android:$gdxVersion"</span><br><span class="line">        natives "com.badlogicgames.gdx:gdx-platform:$gdxVersion:natives-armeabi"</span><br><span class="line">        natives "com.badlogicgames.gdx:gdx-platform:$gdxVersion:natives-armeabi-v7a"</span><br><span class="line">        natives "com.badlogicgames.gdx:gdx-platform:$gdxVersion:natives-x86"</span><br><span class="line">        compile fileTree(dir: 'libs', include: '*.jar')</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>[iOS]</strong><br>Next we need to find the <code>project(&quot;:ios&quot;)</code> section and add <code>compile fileTree(dir: &#39;build/libs&#39;, include: &#39;*.jar&#39;)</code>. It should now look like this:<br><figure class="highlight"><figcaption><span>build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">project(":ios") &#123;</span><br><span class="line">    apply plugin: "java"</span><br><span class="line">    apply plugin: "robovm"</span><br><span class="line">    configurations &#123; natives &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        compile project(":core")</span><br><span class="line">        compile "org.robovm:robovm-rt:$&#123;roboVMVersion&#125;"</span><br><span class="line">        compile "org.robovm:robovm-cocoatouch:$&#123;roboVMVersion&#125;"</span><br><span class="line">        compile "com.badlogicgames.gdx:gdx-backend-robovm:$gdxVersion"</span><br><span class="line">        natives "com.badlogicgames.gdx:gdx-platform:$gdxVersion:natives-ios"</span><br><span class="line">        compile fileTree(dir: 'build/libs', include: '*.jar')</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>[iOS/Android]</strong><br>Save this file. We are done with it. These changes allow Gradle to access the build directories that we placed the mopub bindings in.</p>
<p>In order to actually have Gradle build, we need to tell it to refresh. To do this, <strong>select all of your projects in eclipse, right click, Gradle &gt; Refresh All</strong></p>
<h2 id="Binding_the_Binding_to_the_iOS_Project__5BiOS_5D"><a href="#Binding_the_Binding_to_the_iOS_Project__5BiOS_5D" class="headerlink" title="Binding the Binding to the iOS Project [iOS]"></a>Binding the Binding to the iOS Project [iOS]</h2><p>In order for the ads to work on the device, we need to make sure the compiler knows that it needs to include the SDK. So copy the mopub-1.0.0-SNAPSHOT.jar you just downloaded to ios/build/libs/mopub-1.0.0-SNAPSHOT.jar. Then we need to add these lines to the ios/robovm.xml in order for the compiler to find it.<br><figure class="highlight xml"><figcaption><span>robovm.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Make sure your &lt;frameworks&gt; and &lt;weakFrameworks&gt; tag --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- looks exactly like this. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">frameworks</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>AddressBook<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>AddressBookUI<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>AudioToolbox<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>AVFoundation<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>CoreGraphics<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>CoreLocation<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>CoreMedia<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>CoreTelephony<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>EventKit<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>EventKitUI<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>iAd<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>MediaPlayer<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>MessageUI<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>MobileCoreServices<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>QuartzCore<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>Security<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>SystemConfiguration<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>OpenGLES<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>OpenAL<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>UIKit<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">frameworks</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">weakFrameworks</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>AdSupport<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>PassKit<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>Social<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>StoreKit<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">framework</span>&gt;</span>Twitter<span class="tag">&lt;/<span class="title">framework</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">weakFrameworks</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Add this in-between the two config blocks. Your final robovm.xml should resemble something like this: <a href="https://github.com/BlueRiverInteractive/robovm-ios-bindings/blob/master/mopub/robovm.xml" target="_blank" rel="external">robovm.xml</a>.</p>
<h2 id="Prepare_the_MoPub_SDK_for_the_Android_Project__5BAndroid_5D"><a href="#Prepare_the_MoPub_SDK_for_the_Android_Project__5BAndroid_5D" class="headerlink" title="Prepare the MoPub SDK for the Android Project [Android]"></a>Prepare the MoPub SDK for the Android Project [Android]</h2><p>In order to get ads on Android, we need to import the MoPub SDK.</p>
<p>In Eclipse, go to <strong>File &gt; Import &gt; General &gt; Existing Projects into Workspace</strong>. Next. Click “select archive file”. Browse to where you downloaded the MoPub SDK, and select it. Uncheck the “mopub-sample” project. Click Finish.</p>
<p>We just imported the MoPub SDK into eclipse, but it is not connected to our project at all. To connect it to our project, we need to create a JAR file to link to Gradle, just like we had with the iOS version.</p>
<p>Right click the “mopub-sdk” project &gt; Export &gt; Java &gt; JAR File. Next. <strong>Deselect “AndroidManifest.xml” in the right pane</strong>, this will cause errors if you don’t. For the export destination, select “YOURPROJECT/android/libs” Click Finish.</p>
<h2 id="Make_the_MoPub_SDK_Work_With_the_Android_Project__5BAndroid_5D"><a href="#Make_the_MoPub_SDK_Work_With_the_Android_Project__5BAndroid_5D" class="headerlink" title="Make the MoPub SDK Work With the Android Project [Android]"></a>Make the MoPub SDK Work With the Android Project [Android]</h2><p>Now that we have generated the MoPub SDK JAR, and place in in /android/libs/, we can now tell the Android project to use it.</p>
<p>In your project, open /android/AndroidManifest.xml.</p>
<p>In the <em>manifest</em> tag, add these lines:<br><figure class="highlight xml"><figcaption><span>AndroidManifest.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">uses-permission</span> <span class="attribute">android:name</span>=<span class="value">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">uses-permission</span> <span class="attribute">android:name</span>=<span class="value">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">uses-permission</span> <span class="attribute">android:name</span>=<span class="value">"android.permission.ACCESS_COARSE_LOCATION"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">uses-permission</span> <span class="attribute">android:name</span>=<span class="value">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>If you don’t want to have invasive permissions, you can remove <code>ACCESS_COARSE_LOCATION</code>, however, you will have slightly less earnings.</p>
<p>In the <em>application</em> tag, add these lines:<br><figure class="highlight xml"><figcaption><span>AndroidManifest.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.mopub.mobileads.MoPubActivity"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.mopub.mobileads.MraidActivity"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.mopub.common.MoPubBrowser"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.mopub.mobileads.MraidVideoPlayerActivity"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.google.ads.AdActivity"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.millennialmedia.android.MMActivity"</span> <span class="attribute">android:theme</span>=<span class="value">"@android:style/Theme.Translucent.NoTitleBar"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation|keyboard"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">activity</span> <span class="attribute">android:name</span>=<span class="value">"com.millennialmedia.android.VideoPlayer"</span> <span class="attribute">android:configChanges</span>=<span class="value">"keyboardHidden|orientation|keyboard"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>The MoPub SDK requires some extra permissions in order to work. It also adds a couple extra Activities, which allow the SDK to display ads.</p>
<h2 id="Implementing_Banners_on_iOS__5BiOS_5D"><a href="#Implementing_Banners_on_iOS__5BiOS_5D" class="headerlink" title="Implementing Banners on iOS [iOS]"></a>Implementing Banners on iOS [iOS]</h2><p>To implement the MoPub banners, we need to load an ad from MoPub when the application finishes launching. I only implement banner ads/ leaderboard ads, however if you want to implement interstitials, you can have a look at <a href="https://github.com/BlueRiverInteractive/robovm-ios-bindings/blob/master/mopub/src/org/robovm/bindings/mopub/sample/Sample.java" target="_blank" rel="external">the sample code</a>.<br><figure class="highlight java"><figcaption><span>IOSLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* public class IOSLauncher extends IOSApplication.Delegate */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BANNER_AD_UNIT_ID = <span class="string">"BANNER SIZE iOS ID"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LEADERBOARD_AD_UNIT_ID = <span class="string">"LEADERBOARD SIZE iOS ID"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> CGSize AD_SIZE;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String AD_ID;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> adLoaded = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">private</span> UIViewController rootViewController;</span><br><span class="line"><span class="keyword">private</span> MPAdViewController adViewController;</span><br><span class="line"><span class="keyword">private</span> MPAdView banner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* protected IOSApplication createApplication() */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">didFinishLaunching</span> <span class="params">(UIApplication application, NSDictionary launchOptions)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>.didFinishLaunching(application, launchOptions);   </span><br><span class="line">  <span class="keyword">if</span>(UIScreen.getMainScreen().getBounds().size().width() &gt;= <span class="number">728</span>) &#123;</span><br><span class="line">    System.out.println(<span class="string">"Set as Leaderboard!"</span>);</span><br><span class="line">    AD_SIZE = MPConstants.MOPUB_LEADERBOARD_SIZE;</span><br><span class="line">    AD_ID = LEADERBOARD_AD_UNIT_ID;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">"Set as Banner!"</span>);</span><br><span class="line">    AD_SIZE = MPConstants.MOPUB_BANNER_SIZE;</span><br><span class="line">    AD_ID = BANNER_AD_UNIT_ID;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We need a view controller to see ads.</span></span><br><span class="line">  <span class="comment">//rootViewController = new UIViewController();</span></span><br><span class="line">  <span class="comment">// If you are already using a UIWindow with a root view controller, get the root view controller (f.e. LibGDX):</span></span><br><span class="line">  rootViewController = application.getKeyWindow().getRootViewController();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create a MoPub ad. In this case a banner, but you can make it any size you want.</span></span><br><span class="line">  banner = <span class="keyword">new</span> MPAdView(AD_ID, AD_SIZE);</span><br><span class="line">  <span class="comment">// Let's calculate our banner size. We need to do this because the resolution of a retina and normal device is different.</span></span><br><span class="line">  <span class="keyword">float</span> bannerWidth = UIScreen.getMainScreen().getBounds().size().width();</span><br><span class="line">  <span class="keyword">float</span> bannerHeight = bannerWidth / AD_SIZE.width() * AD_SIZE.height();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Let's set the frame (bounds) of our banner view. Remember on iOS view coordinates have their origin top-left.</span></span><br><span class="line">  <span class="comment">// Position banner on the top.</span></span><br><span class="line">  banner.setFrame(<span class="keyword">new</span> CGRect((UIScreen.getMainScreen().getBounds().size().width()/<span class="number">2</span>)-AD_SIZE.width()/<span class="number">2</span>, <span class="number">0</span>, bannerWidth, bannerHeight));</span><br><span class="line">  <span class="comment">// Position banner on the bottom.</span></span><br><span class="line">  <span class="comment">// banner.setFrame(new CGRect(0, UIScreen.getMainScreen().getBounds().size().height() - bannerHeight, bannerWidth, bannerHeight));</span></span><br><span class="line">  <span class="comment">// Let's color the background for testing, so we can see if it is positioned correctly, even if no ad is loaded yet.</span></span><br><span class="line">  <span class="comment">//banner.setBackgroundColor(new UIColor(1, 0, 0, 1)); // Remove this after testing.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// We use our custom ad view controller to notify for orientation changes.</span></span><br><span class="line">  adViewController = <span class="keyword">new</span> MPAdViewController(banner);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The delegate for the banner. It is required to override getViewController() to get ads.</span></span><br><span class="line">  MPAdViewDelegate bannerDelegate = <span class="keyword">new</span> MPAdViewDelegate.Adapter() &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UIViewController <span class="title">getViewController</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> adViewController;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  banner.setDelegate(bannerDelegate);</span><br><span class="line">  <span class="comment">// Add banner to our view controller.</span></span><br><span class="line">  adViewController.getView().addSubview(banner);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We add the ad view controller to our root view controller.</span></span><br><span class="line">  rootViewController.addChildViewController(adViewController);</span><br><span class="line">  rootViewController.getView().addSubview(adViewController.getView());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!adLoaded) &#123;</span><br><span class="line">    banner.loadAd();</span><br><span class="line">    adLoaded = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create a standard UIWindow at screen size, add the view controller and show it.</span></span><br><span class="line">  application.getKeyWindow().setRootViewController(rootViewController);</span><br><span class="line">  application.getKeyWindow().addSubview(rootViewController.getView());</span><br><span class="line">  application.getKeyWindow().makeKeyAndVisible();</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Your ad should work now, or at least show the demo ad from MoPub, if it does not, or crashes on click, try this with a clean project.</p>
<h2 id="Implementing_Banners_on_Android__5BAndroid_5D"><a href="#Implementing_Banners_on_Android__5BAndroid_5D" class="headerlink" title="Implementing Banners on Android [Android]"></a>Implementing Banners on Android [Android]</h2><p>In order to serve ads on Android, we need to completely re-work the “AndroidLauncher.java” for that reason, please back it up.</p>
<p>Open “/android/AndroidLauncher.java” in Eclipse, and make it look like this. Make sure to rename “MyExampleGame” on line 17<br><figure class="highlight java"><figcaption><span>AndroidLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AndroidLauncher</span> <span class="keyword">extends</span> <span class="title">AndroidApplication</span> </span>&#123;</span><br><span class="line">  MoPubView mAdView;</span><br><span class="line">  <span class="keyword">boolean</span> adLoaded = <span class="keyword">false</span>;</span><br><span class="line">  <span class="keyword">boolean</span> adShown = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">    RelativeLayout layout = <span class="keyword">new</span> RelativeLayout(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    requestWindowFeature(Window.FEATURE_NO_TITLE);</span><br><span class="line">    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,</span><br><span class="line">        WindowManager.LayoutParams.FLAG_FULLSCREEN);</span><br><span class="line">    getWindow().clearFlags(WindowManager.LayoutParams.FLAG_FORCE_NOT_FULLSCREEN);</span><br><span class="line"></span><br><span class="line">    MyExampleGame game = <span class="keyword">new</span> MyExampleGame();</span><br><span class="line"></span><br><span class="line">    View gameView = initializeForView(game, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    layout.addView(gameView);</span><br><span class="line"></span><br><span class="line">    mAdView = <span class="keyword">new</span> MoPubView(<span class="keyword">this</span>);</span><br><span class="line">    mAdView.setAdUnitId(<span class="string">"00000000000000000000000000000"</span>); <span class="comment">// Your MoPub Ad Unit ID</span></span><br><span class="line"></span><br><span class="line">    RelativeLayout.LayoutParams adParams =</span><br><span class="line">        <span class="keyword">new</span> RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT,</span><br><span class="line">            RelativeLayout.LayoutParams.WRAP_CONTENT);</span><br><span class="line">    adParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);</span><br><span class="line">    adParams.addRule(RelativeLayout.CENTER_IN_PARENT);</span><br><span class="line"></span><br><span class="line">    layout.addView(mAdView, adParams);</span><br><span class="line"></span><br><span class="line">    setContentView(layout);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onPause();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mAdView.destroy();</span><br><span class="line">    <span class="keyword">super</span>.onDestroy();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Your ad should work now, or at least show the demo ad from MoPub, if it does not, or crashes on click, try this with a clean project.</p>
<h2 id="Setting_Up_MoPub_to_Serve_Ads"><a href="#Setting_Up_MoPub_to_Serve_Ads" class="headerlink" title="Setting Up MoPub to Serve Ads"></a>Setting Up MoPub to Serve Ads</h2><p>In order to serve AdMob ads, we need to connect AdMob with MoPub. Login to <a href="https://app.mopub.com/account/login/?next=/dashboard/" target="_blank" rel="external">MoPub</a>, and navigate to <a href="https://app.mopub.com/networks/v2/" target="_blank" rel="external">Networks</a>. Click “Add Network”, and choose <a href="https://app.mopub.com/networks/v2/#networks/admob_native" target="_blank" rel="external">AdMob</a>. Login via OAuth, and accept the permissions. AdMob should now be connected, if its not, try OAuth in a different browser. Make a banner and a leaderboard ad in mopub for your app. Then create one banner on AdMob. Copy the Publisher ID for that banner into both Publisher ID fields for both the leaderboard, and the banner (the ids should look like this: “ca-app-pub-0000000000000000000/000000000”)<br>Now navigate to <a href="https://app.mopub.com/advertise/orders/" target="_blank" rel="external">Orders</a>, and Archive all “MoPub Demo Orders”. After a few hours, AdMob Ads should start appearing.</p>
<h2 id="28Optional_29_Show/Hide_Ads_At_Specific_Times"><a href="#28Optional_29_Show/Hide_Ads_At_Specific_Times" class="headerlink" title="(Optional) Show/Hide Ads At Specific Times"></a>(Optional) Show/Hide Ads At Specific Times</h2><p>In order to show/hide ads based on the current state of the application, we need to define two methods; showAd, and hideAd. They do what their names say.</p>
<p>To implement them in [iOS]:<br><figure class="highlight java"><figcaption><span>IOSLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ads</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showAd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"Showing Ad!"</span>);</span><br><span class="line">  <span class="keyword">if</span>(!adLoaded) &#123;</span><br><span class="line">    banner.loadAd();</span><br><span class="line">    adLoaded = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">float</span> bannerWidth = UIScreen.getMainScreen().getBounds().size().width();</span><br><span class="line">  <span class="keyword">float</span> bannerHeight = bannerWidth / AD_SIZE.width() * AD_SIZE.height();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Let's set the frame (bounds) of our banner view. Remember on iOS view coordinates have their origin top-left.</span></span><br><span class="line">  <span class="comment">// Position banner on the top.</span></span><br><span class="line">  banner.setFrame(<span class="keyword">new</span> CGRect((UIScreen.getMainScreen().getBounds().size().width()/<span class="number">2</span>)-AD_SIZE.width()/<span class="number">2</span>, <span class="number">0</span>, bannerWidth, bannerHeight));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hideAd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"Hiding Ad!"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">float</span> bannerWidth = UIScreen.getMainScreen().getBounds().size().width();</span><br><span class="line">  <span class="keyword">float</span> bannerHeight = bannerWidth / AD_SIZE.width() * AD_SIZE.height();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Let's set the frame (bounds) of our banner view. Remember on iOS view coordinates have their origin top-left.</span></span><br><span class="line">  <span class="comment">// Position banner above the top.</span></span><br><span class="line">  banner.setFrame(<span class="keyword">new</span> CGRect(<span class="number">0</span>, -bannerHeight, bannerWidth, bannerHeight));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>And in [Android]<br><figure class="highlight java"><figcaption><span>AndroidLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ads</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showAd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(!adLoaded) &#123;</span><br><span class="line">        System.out.println(<span class="string">"Ad Loaded!"</span>);</span><br><span class="line">        mAdView.loadAd();</span><br><span class="line">        adLoaded = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(!adShown) &#123;</span><br><span class="line">        System.out.println(<span class="string">"Ad Show!"</span>);</span><br><span class="line">        mAdView.setVisibility(View.VISIBLE);</span><br><span class="line">        adShown = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hideAd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(adShown) &#123;</span><br><span class="line">    runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">      <span class="annotation">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mAdView.setVisibility(View.GONE);</span><br><span class="line">        System.out.println(<span class="string">"Ad Hide!"</span>);</span><br><span class="line">        adShown = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>We will place the ad above the top of the screen for safe keeping. We will not dispose that ad, because ads take a long time to load, and we don’t want to try and load an ad every time we show an ad.<br>Alright, so now that we have those methods, we need to call them. If you only have a RoboVM only app, it is pretty straight forward; just call the methods when you want to do the respective command.<br>If however, you have a LibGDX app like me, you will need to have a little more complex system.</p>
<h2 id="28Optional_29_Creating_Listeners_For_LibGDX_Applications"><a href="#28Optional_29_Creating_Listeners_For_LibGDX_Applications" class="headerlink" title="(Optional) Creating Listeners For LibGDX Applications"></a>(Optional) Creating Listeners For LibGDX Applications</h2><p>In order for the core project to communicate with the RoboVM project, the RoboVM project must contact it before it can act. We do this with events and listeners. First we create a Listener.java interface in the core LibGDX project which will be inherited by the listeners in the RoboVM project.<br><figure class="highlight java"><figcaption><span>Listener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Listener</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> ListenerType <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Then we need to create a manager to control, and keep track of all the listeners in the core project. We also need listener types which can be registered. This is the “ListenerType” enum.<br><figure class="highlight java"><figcaption><span>ListenerManager.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListenerManager</span> </span>&#123;</span><br><span class="line">  ArrayList&lt;Listener&gt; listeners;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ListenerManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    listeners = <span class="keyword">new</span> ArrayList&lt;Listener&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Listener l)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(listeners == <span class="keyword">null</span>) &#123;</span><br><span class="line">      listeners = <span class="keyword">new</span> ArrayList&lt;Listener&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    listeners.add(l);</span><br><span class="line">    System.out.println(<span class="string">"Listener Added!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(ListenerType type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(Listener l : listeners) &#123;</span><br><span class="line">      <span class="keyword">if</span>(l.type() == type) &#123;</span><br><span class="line">        l.call();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">enum</span> ListenerType &#123;</span><br><span class="line">    SHOWAD, HIDEAD</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Once these files are created, we can go back to our RoboVM project which can now use the Listener class. We will create two files “ShowAdListener.java”, and “HideAdListener.java”, which will be triggered when the core project calls the proper methods.<br><figure class="highlight java"><figcaption><span>ShowAdListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShowAdListener</span> <span class="keyword">implements</span> <span class="title">com</span>.<span class="title">example</span>.<span class="title">Listener</span> </span>&#123;</span><br><span class="line">  IOSLauncher base;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.base.showAd();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBase</span><span class="params">(RobovmLauncher base)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.base = base;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ListenerType <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ListenerType.SHOWAD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><figure class="highlight java"><figcaption><span>HideAdListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HideAdListener</span> <span class="keyword">implements</span> <span class="title">com</span>.<span class="title">example</span>.<span class="title">Listener</span> </span>&#123;</span><br><span class="line">  RobovmLauncher base;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.base.hideAd();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBase</span><span class="params">(RobovmLauncher base)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.base = base;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ListenerType <span class="title">type</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ListenerType.HIDEAD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>You need to change the implementation to the path of the Listener.java you created. Now we need to create an instance of each listener, and register them with the ListenerManager. Go to your RobovmLauncher, and modify the createApplication() method to look like this so the Game has a chance to get the listeners registered. Make sure to rename “MyExampleGame” to your main game class.<br><figure class="highlight java"><figcaption><span>IOSLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> IOSApplication <span class="title">createApplication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  IOSApplicationConfiguration config = <span class="keyword">new</span> IOSApplicationConfiguration();</span><br><span class="line">  config.orientationLandscape = <span class="keyword">true</span>;</span><br><span class="line">  config.orientationPortrait = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  game = <span class="keyword">new</span> MyExampleGame();</span><br><span class="line"></span><br><span class="line">  ShowAdListener show = <span class="keyword">new</span> ShowAdListener();</span><br><span class="line">  HideAdListener hide = <span class="keyword">new</span> HideAdListener();</span><br><span class="line"></span><br><span class="line">  show.setBase(<span class="keyword">this</span>);</span><br><span class="line">  hide.setBase(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">  game.addListener(show);</span><br><span class="line">  game.addListener(hide);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> IOSApplication(game, config);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>And do the same thing on [Android]. Between <code>MyExampleGame game = new MyExampleGame();</code> and <code>View gameView = initializeForView(game, true);</code> put this extra code:<br><figure class="highlight java"><figcaption><span>AndroidLauncher.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyExampleGame game = new MyExampleGame();</span></span><br><span class="line"></span><br><span class="line">ShowAdListener show = <span class="keyword">new</span> ShowAdListener();</span><br><span class="line">HideAdListener hide = <span class="keyword">new</span> HideAdListener();</span><br><span class="line"></span><br><span class="line">show.setBase(<span class="keyword">this</span>);</span><br><span class="line">hide.setBase(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">game.addListener(show);</span><br><span class="line">game.addListener(hide);</span><br><span class="line"></span><br><span class="line"><span class="comment">// View gameView = initializeForView(game, true);</span></span><br></pre></td></tr></table></figure></p>
<p>Now that the listeners are setup, we can start showing/hiding ads! Go back to your core project, and find a place where you want to show the ad (Game Over Screen, Settings, etc.), and call the event from the ListenerManager.<br><figure class="highlight java"><figcaption><span>GameScreen.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* public void gameOver() &#123; */</span></span><br><span class="line">listenerManager.call(ListenerType.SHOWAD);</span><br><span class="line"><span class="comment">/* &#125; */</span></span><br></pre></td></tr></table></figure></p>
<p>and a place to hide the ad (when the game starts, main menu, etc.)<br><figure class="highlight java"><figcaption><span>GameScreen.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* public void newGame() &#123; */</span></span><br><span class="line">listenerManager.call(ListenerType.HIDEAD);</span><br><span class="line"><span class="comment">/* &#125; */</span></span><br></pre></td></tr></table></figure></p>
<p>Also make sure to create an instance of the ListenerManager, and add the addListener() method to your main game class before you try to call an event.<br><figure class="highlight java"><figcaption><span>MyExampleGame.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListenerManager listenerManager;</span><br><span class="line"><span class="comment">/* public MyExampleGame() &#123; */</span></span><br><span class="line">listenerManager = <span class="keyword">new</span> ListenerManager();</span><br><span class="line"><span class="comment">/* &#125; */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addListener</span><span class="params">(Listener l)</span> </span>&#123;</span><br><span class="line">  listenerManager.add(l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Cool! Now you should have AdMob ads running in your application, and the ability to show/hide the ad! If the demo ads are still showing, give it 24 hours.</p>

  
</div>

</article>

  <div class="after-post">
  <h3>Sam Schooler</h3>
</div>

</section>

      <footer></footer>

    </div>
    <script src="/js/theme.min.js"></script>

  </body>
</html>

